<%- include("../partials/header") %>
<%- include("../partials/sidebar") %>

<div class="content" id="content">
  <h1>Projects</h1>

  <a class="btn-add" href="/admin/projects/add" id="addProjectBtn">+ Add Project</a>

  <div class="projects-container">
    <% projects?.forEach((project, index) => { %>
      <div class="project-item"> 
        <div class="project-header">
          <h3><%= project.title %> <% if(project.isFeatured) { %>‚≠ê<% } %></h3>
          <% if(project.coverImageUrl) { %>
            <a href="<%= url %>/uploads/images/<%= project.coverImageUrl %>" data-fancybox>
          <img  style="max-width: 200px; margin-bottom: 10px;" src="<%= url %>/uploads/images/<%= project.coverImageUrl %>" alt="<%= project.title %> Cover" class="project-cover">
          </a>
        <% } %>
       
        </div>
        
        <p class="project-short-description"><%= project.shortDescription %></p>
        <% if(project.longDescription) { %>
          <p class="project-long-description"><%= project.longDescription %></p>
        <% } %>
        <div class="project-links">
          <% if(project.githubUrl) { %>
            <a href="<%= project.githubUrl %>" target="_blank">GitHub</a>
          <% } %>
          <% if(project.liveUrl) { %>
            <a href="<%= project.liveUrl %>" target="_blank">Live</a>
          <% } %>
        </div>
           <div style="margin-top: 1rem;">
            <a class="btn-edit" href="/admin/projects/edit/<%= project.id%>">Edit</a>
        <a href="#" 
   class="btn-delete" 
   onclick="if(confirm('Are you sure you want to delete this project?')) { 
              fetch('/admin/project/delete/<%= project.id %>', { method: 'POST' })
                .then(() => location.reload())
                .catch(err => alert('Error deleting project'));
            } 
            return false;">
   Delete
</a>

          </div>
      </div>
      
    <% }) %>
  </div>

</div>

<% if (success) { %>
<script>
  iziToast.success({
    title: 'Success',
    message: <%- JSON.stringify(success) %>,
    timeout: 5000,

    // CUSTOM SIZE
    maxWidth: 500,       // increase width (default ~350px)
    titleSize: '24px',   // bigger title font
    messageSize: '18px', // bigger message font
    padding: 30,         // more padding inside toast
    balloon: true,       // optional: makes it more prominent
  });
</script>
<% } %>

<% if (error) { %>
<script>
  iziToast.error({
    title: 'Error',
    message: <%- JSON.stringify(error) %>,
    timeout: 5000,

    // CUSTOM SIZE
    maxWidth: 500,       // increase width (default ~350px)
    titleSize: '24px',   // bigger title font
    messageSize: '18px', // bigger message font
    padding: 30,         // more padding inside toast
    balloon: true,       // optional: makes it more prominent
  });
</script>
<% } %>


<%- include("../partials/footer") %>
