<%- include("partials/header") %>
<%- include("partials/sidebar") %>

<div class="content" id="content">
  <h1>Profile Info</h1>

 <% if (user && user.profile && user.profile.imageUrl) { %>
  <div class="profile-photo">
    <a href="<%= websiteUrl %>/uploads/images/<%= user.profile.imageUrl %>" data-fancybox data-caption="Single image">
      <img src="<%= websiteUrl %>/uploads/images/<%= user.profile.imageUrl %>" alt="Profile Photo">
    </a>
  </div>
<% } %>


   <form action="/admin/upload/profile" method="POST" enctype="multipart/form-data">
      <input type="file" name="file" accept="image/*" required>
      <button type="submit">Change Photo</button>
  </form>

  <br><br>

    <% if (user.profile.cvUrl) { %>
  <!-- Show existing CV with a link -->
  <div class="existing-cv">
    <a href="<%=websiteUrl%>/uploads/cv/<%= user.profile.cvUrl %>"  target="_blank">View current CV</a>
    <p>If you want to replace it, upload a new file:</p>
  </div>
  <% } %>

  <form action="/admin/upload/cv" method="POST" enctype="multipart/form-data">

      <div class="form-group">
        <label>CV</label>
        <input type="file" name="file">
      </div>

      <button type="submit">Upload CV</button>

  </form>

  <br><br>

  <form action="/admin/profile/<%= user.profile.id %>" method="POST">

    <div class="form-group">
      <label>Summary</label>
      <textarea name="bio" rows="4"><%= user.profile.bio %></textarea>
    </div>



    <div class="form-group">
      <label>Email</label>
      <input type="email" name="email" value="<%= user.profile.email %>">
    </div>

    <div class="form-group">
      <label>Full Name</label>
      <input type="text" name="fullName" value="<%= user.profile.fullName %>">
    </div>

    <div class="form-group">
      <label>Title</label>
      <input type="text" name="title" value="<%= user.profile.title %>">
    </div>

    <div class="form-group">
      <label>Address</label>
      <input type="text" name="location" value="<%= user.profile.location %>">
    </div>

    <div class="form-group">
      <label>Phone</label>
      <input type="text" name="phone" value="<%= user.profile.phone %>">
    </div>

    <div class="form-group">
      <label>LinkedIn</label>
      <input type="text" name="linkedinUrl" value="<%= user.profile.linkedinUrl %>">
    </div>

    <div class="form-group">
      <label>GitHub</label>
      <input type="text" name="githubUrl" value="<%= user.profile.githubUrl %>">
    </div>

    <div class="form-group">
      <label>Website</label>
      <input type="text" name="websiteUrl" value="<%= user.profile.websiteUrl %>">
    </div>

    <div class="form-group">
      <label>Degree</label>
      <input type="text" name="degree" value="<%= user.profile.degree %>">
    </div>

    <button type="submit">Save Changes</button>
  </form>

</div>

  <% if (error) { %>
<script>
  iziToast.error({
    title: 'Error',
    message: <%- JSON.stringify(error) %>,
    timeout: 5000,

    // CUSTOM SIZE
    maxWidth:400,       // increase width (default ~350px)
    titleSize: '24px',   // bigger title font
    messageSize: '18px', // bigger message font
    padding: 30,         // more padding inside toast
    balloon: true,       // optional: makes it more prominent
  });
</script>
<% } %>


  <% if (success) { %>
<script>
  iziToast.success({
    title: 'Success',
    message: <%- JSON.stringify(success) %>,
    timeout: 5000,

    // CUSTOM SIZE
    maxWidth:400,       // increase width (default ~350px)
    titleSize: '24px',   // bigger title font
    messageSize: '18px', // bigger message font
    padding: 30,         // more padding inside toast
    balloon: true,       // optional: makes it more prominent
  });
</script>
<% } %>


<%- include("partials/footer") %>
